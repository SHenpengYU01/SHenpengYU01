# 缺省逻辑

缺省推理属于非单调推理，在本质上是定性的。非单调性：当出现新信息时，已经被推出的错误结论可以被回收。

## 缺省规则

表示为 $\phi: \psi/\eta$，读作“如果可以证明 𝜙，且 𝜓 是一致的（或者，等价地，不能证明 ¬𝜓，
即：例外 ¬𝜓 没有发生），那么可以推出 𝜂。

- 例子：

封闭世界假设：如果一个句子为真，那么知道它为真。依据这个假设，可以把一个应用领域描述为一些公理的集合，并以如下方式来推理：若一个命题不能从公理推出，则它是假的。用缺省规则表示为

$$
\frac{\top : \neg \phi}{\neg \phi}
$$


## 缺省逻辑的语法

!!! info "缺省逻辑的语言"
    任何一阶语言是缺省逻辑的语言。因此，在缺省逻辑中，所用到的项、公式等的定义与一阶语言里的相同。


!!! info "缺省规则"
    一条缺省规则可以被形式化地表示为：  
    $\delta=\frac{\phi: \psi_1,...,\psi_n}{\chi}$
    其中，$\phi, \psi_1,...,\psi_n$ 是一阶逻辑公式，𝑛 ≥ 0。公式 𝜑 称为**先决条件**，$\psi_1,...,\psi_n$
    是**缺省条件**（或正当性条件），𝜒 是 𝛿 的结论。
    有时，用 𝑝𝑟𝑒(𝛿) （prerequisite）表示 𝜑，用 𝑗𝑢𝑠𝑡(𝛿)（justification） 表示 $\psi_1,...,\psi_n$，
    用 𝑐𝑜𝑛𝑠(𝛿)表示 𝜒。对于缺省规则集合 𝐷，用 𝑐𝑜𝑛𝑠(𝐷) 表示 𝐷 中缺省的结论集合。
    为简便起见，缺省规则也可表示为 $\phi : \psi_1,...,\psi_n/\chi$。


!!! info "规范缺省规则"
    当一条缺省规则的缺省条件和结论相同时，称为规范的，形如 $\phi:\chi/\chi$

!!! info "缺省理论"
    一个缺省理论是一个二元组 𝑇 = ⟨𝑊, 𝐷⟩, 其中 𝑊 是一阶逻辑公式集合，用于表示已知的或约定的事实集合；𝐷 是一个可数的缺省规则集合。
    当 𝐷 中所有规则是闭规则时，称理论 𝑇 = ⟨𝑊, 𝐷⟩ 是闭理论。

    闭规则：规则中所有变量 x 都被全称量化（即规则中不包含自由变量），则称该规则是闭规则。

## 缺省逻辑的语义

给定一个缺省理论，其**语义**指的是可以接受或相信哪些语句。被接受或相信的语句集合称为**外延**。

### 外延的不动点定义

应用缺省规则来扩充信念时需要考虑哪些规则可以被应用，这取决于这些规则所参考的背景。一种最直观的方法是把事实集合作为背景，但是这是错误的没因为可能会产生一对不一致的结论。所以需要考虑在应用规则之后各条规则的结论对其他规则的缺省条件的影响。

在应用缺省规则时，可以指定一个语句集合来作为规则应用的背景，并把被相信成立的语句放在另外一个集合中，于是有

!!! info "缺省规则的应用"
    给定两个句子集合 Φ 和 Ψ，以及一条缺省规则 $\delta = \phi : \psi_1,...,\psi_n/\chi$，
    我们说在 Φ 下把 𝛿 应用于 Ψ，意指：如果 𝜑 ∈ Ψ，
    而且 $\neg \phi_1\notin \Phi,...\neg \phi_n \notin \Phi$，那么 𝜒 ∈ Ψ。当 Φ = Ψ 时，
    我们也说把 𝛿 应用于 Ψ。


!!! info "缺省规则的可应用性"
    缺省规则 $\delta = \phi : \psi_1,...,\psi_n/\chi$ 可应用于一组命题集合 𝐸, 当且仅当 𝜑 ∈ 𝐸，
    而且 $\neg \phi_1\notin E,...\neg \phi_n \notin E$。

给定 𝑇 和 Φ，如何产生 Ψ？定义Γ算子作用于Φ：

!!! info "极小扩充语句集合"
    设论 𝑇 = ⟨𝑊, 𝐷⟩ 是一个缺省理论，Γ 为关于 𝐷 的一个算子，Γ 作用于任意的语句集合Φ，产生满足下列三个性质的极小语句集合 Γ(Φ)：

    (i) 𝑊 ⊆ Γ(Φ)。
    
    (ii) 𝑇 ℎ(Γ(Φ)) = Γ(Φ)，这里 𝑇 ℎ(Γ(Φ)) 为语句集 {𝜙 | Γ(Φ) ⊢ 𝜙}。
    
    (iii) 对于 𝐷 中的任何缺省规则 $\delta = \phi : \psi_1,...,\psi_n/\chi$，
    在 Φ 下把 𝛿 应用于 Γ(Φ)，即：如果 𝜑 ∈ Γ(Φ)，而且 ¬𝜓1 ∉ Φ, . . . , ¬𝜓𝑛 ∉ Φ，那么 𝜒 ∈ Γ(Φ)。


!!! info "外延的不动点定义"
    句子集合 𝐸 是缺省理论 𝑇 = ⟨𝑊, 𝐷⟩ 的一个外延当且仅当 𝐸 是算子 Γ 的一个不动点，即Γ(𝐸) = 𝐸。


!!! note "准归纳的外延定义（有构造性）"
    设 𝐸 为一阶命题集，𝑇 =< 𝑊, 𝐷 > 为一闭的缺省理论。递归定义 𝐸𝑖 (𝑖 = 1, 2, . . . ) 如下：

    $E_0 = W$
    
    $E_{i+1}=Th(E_i)\cup\left\{\chi| \frac{\phi:\phi_1,...\phi_n}{\chi}\in D,\phi\in E_i, \neg \psi_j\notin E,1\geq j \leq m \right\}$
    
    那么 E是T的一个外延当且仅当 $E=\cup^\infty _{i=0} E_i$


!!! note "定理"
    1. 闭缺省定理 $T=<W,D>$有不一致的外延 𝐸，当且仅当 𝑊 不一致。
    2. 任何正规缺省理论都有一个外延。

### 外延的操作定义

外延的不动点定义不是完全建构性的，因此，为了获得一个缺省理论的外延，需要**假定
可能的命题集合**，再从这些命题集合出发，判断哪些集合是外延。

现在介绍一种建构性的外延定义方法，称为外延的操作定义。该方法通过缺省规则的
**实施过程树**来定义外延。

符号约定：

给定一个缺省理论 𝑇 = ⟨𝑊, 𝐷⟩，把一个缺省规则的序列记作 Π = (𝛿0, 𝛿1, . . . )，其中每条规则最多在 Π 中出现一次。这个序列可以看作是规则实施的顺序。

- 用 Π[𝑘] 表示 Π 的长度为 𝑘 的初始段
- 用 𝐼𝑛(Π) = 𝑇 ℎ(𝑊 ∪ {𝑐𝑜𝑛𝑠(𝛿) | 𝛿在Π中出现}) 表示实施 Π 中的规则而得到的结论集合
- 用 𝑂𝑢𝑡(Π) = {¬𝜓 | 𝜓 ∈ 𝑗𝑢𝑠𝑡(𝛿), 𝛿在Π中出现} 表示在实施 Π 中的规则后不能为真的公集合


!!! info "过程"
    设 𝑇 = ⟨𝑊, 𝐷⟩ 是一个缺省理论，Π = (𝛿0, 𝛿1, . . . ) 是 𝑇 的一个缺省规则序列。  
    Π 是𝑇 的一个过程，当且仅当对于 Π 每条规则 𝛿𝑘 , 𝑘 ≥ 0，可把 𝛿𝑘 应用于 𝐼𝑛(Π[𝑘])。  
    Π 是成功的，当且仅当 𝐼𝑛(Π) ∩ 𝑂𝑢𝑡(Π) = ∅。  
    Π 是封闭的，当且仅当对于任意 𝛿 ∈ 𝐷，如果它可以被应用于 𝐼𝑛(Π)，则它在 Π 中。


!!! info "外延的操作定义"
    设 𝑇 = ⟨𝑊, 𝐷⟩ 是一个缺省理论。一组公式集合 𝐸 是 𝑇 的一个外延，当且仅当有一个成功且封闭的 𝑇 的过程 Π，使得 𝐸 = 𝐼𝑛(Π)。


!!! info "过程树"
    设 𝑇 = ⟨𝑊, 𝐷⟩ 是一个缺省理论。𝑇 的过程树定义如下：
    树的每个节点标记 In 命题集合和 Out 命题集合。其中，根节点的 In 命题集合为 𝑇ℎ(𝑊), OUT 命题集合为空集。
    其他非根节点的 In 命题集合和 Out 命题集合取决于从根节点到该非根节点所应用的缺省规则。
    设 Π[𝑘] = (𝛿0, . . . , 𝛿𝑘 ) 为过程树中从根节点到某个非根节点的长度为 𝑘 的路径，
    则该非根节点的 In 命题集合为 𝐼𝑛(Π[𝑘])，Out 命题集合为𝑂𝑢𝑡(Π[𝑘])。
    从根节点到每个叶节点的路径对应于 𝑇 的一个过程。对于一个过程，如果其中存在一个节点，它的 In 命题集合和 Out 命题集合的交集为非空，那么该过程是失败的。

<img src="\img\study\ai\ailogic\process-tree.png" alt="过程树" title="过程树示例">


## 缺省证明

!!! info "规范缺省证明"
    一个缺省理论$T=<W,D>$是规范的，如果D的所有缺省规则都是规范的。

!!! info "缺省证明"
    设 𝑇 = ⟨𝑊, 𝐷⟩ 是一个规范的缺省理论。称一阶命题 𝜙 是有 𝑇 中的一个缺省证明，记作 $T\vdash \phi$，如果存在 𝐷 的有穷子集的有穷序列 𝐷0, 𝐷1, . . . , 𝐷𝑛，使得：

    (1) 𝑊 ∪ 𝑐𝑜𝑛𝑠(𝐷0) ⊢ 𝜙。  

    (2) 对于整数$i$,$1 \leq i \leq n$ 及$pre(D_{i-1})$中每一 $\phi$，$W\cup cons(D_i) \vdash \phi$  

    (3) $D_n=\emptyset$  

    (4) $W\cup \cup^{n}_{i=0} D_i$ 是一致的。  

!!! note "定理"
    设 T=<W,D>是一个规范的缺省理论, 𝜙 为一阶命题。那么，𝑇 中能推出 𝜙，即 𝑇 中有含𝜙 的外延，当且仅当 𝜙 在 𝑇 中有一个缺省证明。

## 怀疑的结论或轻信的结论

!!! info "怀疑或轻信的结论"
    设 $T=<W,D>$ 是一个缺省理论， $\phi$ 为一阶命题。那么，  

    - T 怀疑推出 $\phi$ ，当且仅当对于 T 的所有外延， $\phi$ 都在该外延中，即 $\phi \in \cap_{E\in ext(T)}E$；

    - T 轻信推出 $\phi$ ，当且仅当存在 T 的某个外延，使得 $\phi$ 在该外延中，即 $\phi \in \cup_{E\in ext(T)E}$


